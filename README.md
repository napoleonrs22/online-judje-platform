# Online Judge Platform

Это полноценная платформа для онлайн-оценки кода, созданная с использованием микросервисной архитектуры. Платформа позволяет пользователям решать задачи по программированию, отправлять свой код и получать мгновенную обратную связь.

## Архитектура

Проект состоит из трех основных сервисов, которые работают вместе в Docker-контейнерах:

- **`online-judge-frontend` (Next.js)**: Пользовательский интерфейс, созданный с помощью Next.js и React. Он обеспечивает интерактивную среду для пользователей, включая редактор кода, страницы задач и отображение результатов.
- **`fastapi-backend` (Python & FastAPI)**: Бэкенд-API, который служит ядром приложения. Он управляет данными о пользователях, задачах, отправках и аутентификации.
- **`go-executor` (Go)**: Безопасный исполнитель кода, который компилирует и запускает отправленный пользователем код в изолированных Docker-контейнерах. Он оценивает вывод кода по предопределенным тестовым случаям и возвращает результат.

Дополнительные компоненты:
- **`PostgreSQL`**: Реляционная база данных для хранения всей информации.
- **`Docker-Compose`**: Инструмент для определения и запуска многоконтейнерных Docker-приложений.

## Технологии

### Фронтенд (`online-judge-frontend`)
- **Фреймворк**: Next.js (React)
- **Язык**: TypeScript
- **Стилизация**: Tailwind CSS
- **Редактор кода**: CodeMirror
- **UI Компоненты**: Lucide React, Framer Motion

### Бэкенд (`fastapi-backend`)
- **Фреймворк**: FastAPI
- **Язык**: Python
- **База данных**: PostgreSQL с использованием SQLAlchemy (асинхронно с `asyncpg`)
- **Миграции**: Alembic
- **Аутентификация**: JWT (JSON Web Tokens)
- **Сервер**: Uvicorn

### Исполнитель кода (`go-executor`)
- **Язык**: Go
- **Среда выполнения**: Взаимодействие с Docker Engine для создания и управления контейнерами для каждой отправки.
- **Поддерживаемые языки**: C++ (gcc), Java (eclipse-temurin), Python, JavaScript (node).

## Начало работы

### Требования
- Docker
- Docker Compose

### Установка и запуск

1. **Создайте файл `.env`**:
   Создайте файл `.env` в корневом каталоге проекта, скопировав содержимое из примера ниже. Замените значения на свои, если это необходимо.

   ```env
   # PostgreSQL
   POSTGRES_USER=admin
   POSTGRES_PASSWORD=admin
   POSTGRES_DB=online_judge
   DB_HOST=db
   DB_PORT=5432
   DATABASE_URL=postgresql+asyncpg://admin:admin@db:5432/online_judge

   # Code Executor
   CODE_EXECUTION_URL=http://code-executor:8001/api/execute
   JUDGER_SHARED_DIR=/tmp/judger
   ```

2. **Запустите проект с помощью Docker Compose**:
   Откройте терминал в корневой папке проекта и выполните следующую команду:

   ```bash
   docker-compose up --build
   ```
   Эта команда соберет образы для каждого сервиса и запустит все контейнеры. Первый запуск может занять некоторое время, так как `docker-compose` загрузит все необходимые базовые образы (Postgres, Python, Go, GCC и т.д.).

3. **Создайте задачи в базе данных**:
   После успешного запуска всех сервисов, откройте новый терминал и выполните скрипт для наполнения базы данных начальными задачами.

   ```bash
   ./create_problems.sh
   ```
   *Примечание: Скрипт использует заранее заданный токен аутентификации. Если вы измените логику аутентификации или пользователей по умолчанию, вам может потребоваться сгенерировать новый токен.*

4. **Откройте приложение**:
   - **Фронтенд**: [http://localhost:3000](http://localhost:3000)
   - **Бэкенд (API Docs)**: [http://localhost:8000/docs](http://localhost:8000/docs)

## Структура проекта

```
.
├── docker-compose.yml       # Файл конфигурации для запуска всех сервисов
├── fastapi-backend/         # Бэкенд-сервис на FastAPI
├── go-executor/             # Сервис для выполнения кода на Go
├── online-judge-frontend/   # Фронтенд-приложение на Next.js
├── create_problems.sh       # Скрипт для добавления задач в БД
├── init-images.sh           # Скрипт для инициализации образов Docker
```